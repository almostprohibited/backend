name: Publish (beta)
on:
  push:
    branches: [develop]
  workflow_dispatch:
env:
  BINARY_PATH: "/home/ubuntu/almostprohibited/backend-beta"
  STAGE: "beta"
jobs:
  build:
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      - name: Build
        uses: ./.github/actions/build
        with:
          binary-path: ${{ env.BINARY_PATH }}
  deploy:
    needs: [build]
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      - name: Deploy
        uses: ./.github/actions/deploy
        with:
          binary-path: ${{ env.BINARY_PATH }}
          stage: ${{ env.STAGE }}
          token: ${{ secrets.DEPLOYMENT_ACCESS }}
